\section{Inferring User State from Location Data}


% Using location data to infer behaviour and mental state
% Litterature review should indicate which features are relevant
% Feature are anything derived from the location data, i.e. clusters, trajectories, number of clusters etc.


% Saeb
%   More related to mental health
%   Can we infer users mental state from location data
%   A list of mobility features provided, which this thesis to large extent is based upon
%   Does not discuss how the Circadian Movement feature is computed exactly
%   It was not defined in a way which allowed it to be directly replicated
%   PHQ9 questionnaire
%   Our study suggests that it is possible to monitor depression passively using phone sensor data, and in particular, GPS. This has significant public health implications. Most people are unwilling to answer questions repeatedly over long periods of time, while passive monitoring could improve the management of depression in populations, allowing at risk patients to be treated more quickly as symptoms emerge, or monitoring patientsâ€™ responses during treatment.

The work done by Saeb et al. \cite{Saeb2015, saeb2016} and Canzian et al. \cite{Canzian2015} forms the basis of this thesis with regard to mobility features. These two contributions give definitions of a wide list of mobility features and relate them to mental state and user behaviour. The mobility features proposed by Saeb et al. are outlined in Table \ref{tab:saeb-features} and of these features the authors found that Home Stay, Location Variance, Normalized Entropy and Circadian movement correlate strongly with the PHQ9 score. Clinical assessment of depressive symptoms is usually done using questionnaires, such as the patient health questionnaire (PHQ-9). These questionnaires evaluate symptoms related to the patients state of mind, which for depressed patients tend to change. Saeb et al. finds a strong correlation between certain mobility features and the PHQ9 score obtained by the patients in a field study. Their findings therefore indicate that it is possible to monitor depression passively using GPS data tracked via the smart-phone. They explain that most people are unwilling to answer questions repeatedly over long periods of time, which is the case with an evaluation system based on the PHQ9 questionnaire. Passive monitoring via the patients smartphone could great improve the management of depression in populations by discovering relapses of high-risk patients earlier, so that they may receive the treatment they need before it is too late. 

% Canzian
%   Very much like Saeb
%   Provides more details wrt to how features are computed
%   Uses PHQ8 as reference 
%   In this work we have demonstrated that it is possible to ob- serve a significant correlation between mobility patterns and depressive mood using data collected by means of smart- phones. We have also shown that it is possible to develop in- ference algorithms as a basis for unobtrusive monitoring and prediction of depressive mood disorders.

The work by Canzian et al. is similar is discusses how existing digital systems for diagnosing depression require the user to interact with the device. These interactions can be inputs such as mood-state provided a few times a day, which is highly subjective and thus error-prone. Canzian et al. addresses this issue via objective patient data, namely the mobility patterns of users. These patterns were derived from location data gathering through smartphone apps, which as Canzian et al. puts it, is unobtrusive monitoring. These patterns are described by the mobility metrics (i.e. features) listed in Table \ref{tab:canzian-features}. The authors found a significant correlation between these metrics and depressive moods similar to \cite{Saeb2015} for which the \textit{PHQ-8} questionnaire is used as  reference. This is the same questionnaire as the PHQ9, although only containing the first 8 questions. While Canzian et al. and Saeb et al. describe many of the same features, Canzian provides much more detailed definitions of the features. A good example of this is the \textit{Routine Index} feature, which loosely corresponds to the \textit{Circadian Rhythm} feature in \cite{Saeb2015}. Canzian et al. \cite{Canzian2015} uses the notion of trajectories including \textit{stops} and \textit{moves} defined by \cite{trajectories2008} to define the mobility trace feature. This feature is used to derive the rest of the features, which is also the approach used for this thesis, although the terminology differs slightly.

The work by Cuttone et al. \cite{sparse-location-2014} investigates how accurate significant locations can be inferred from sparsely sampled location data using the GPS tracker in smartphones. For longitudinal studies it can be a problem for the phone battery if the sampling rate is too high. Therefore a more low-energy approach is used where the sampling rate- and the location accuracy are low. A small-scale study was conducted in which location data collected continuously and the users filled out an online diary on a daily basis. The aim was to compute features \textit{Stops} and \textit{Places of Interest (POI)} for each user and match them with the provided answers. These features are described in Table \ref{tab:features-cuttone}.  To find Stops, both a \textit{Gaussian Mixture Model}, as well as the \textit{DBSCAN} algorithm, were applied for clustering. To evaluate the best model, the $f_1$ score of each model was computed, and in the end, it was found that both algorithms performed similarly for each of the participants. Inspiration was taken from this paper for conducting a small scale study where computed features were compared to subjective answers from the participants. 

\begin{table}[]
    \centering
\begin{tabular}{|p{0.4\textwidth}|p{0.5\textwidth}|}
\hline
{\ul \textbf{Feature}}       & {\ul \textbf{Description}}                                                                                                                                        \\ \hline
Place of Interest (POI)                        & \textit{Location of relevance frequented by the user, e.g. home, gym or workplace}                                                                                                                    \\ \hline
Stop            & \textit{A visit to a POI with an arrival- and departure timestamp}                                                                                  \\ \hline
\end{tabular}
    \caption{The Mobility Features defined by Cuttone et al. \cite{sparse-location-2014}}
    \label{tab:features-cuttone}
\end{table}


\begin{table}[h]
    \centering
\begin{tabular}{|p{0.4\textwidth}|p{0.5\textwidth}|}
\hline
{\ul \textbf{Feature}}      & {\ul \textbf{Description}}                                                                                                                     \\ \hline
Number of Clusters          & \textit{Number of clusters found by the clustering algorithm}                                       \\ \hline
Home Stay                   & \textit{Percentage of time stayed at the home cluster}                                              \\ \hline
Location Variance           & \textit{Variance of the location of stationary points}                                              \\ \hline
Location Entropy            & \textit{Entropy of the time distribution wrt. clusters}                                             \\ \hline
Normalized Location Entropy & \textit{Entropy normalized by the maximum possible entropy. Invariant to the number of clusters} \\ \hline
Transition Time             & \textit{Percentage of time in not stationary}                                                                                                  \\ \hline
Total Distance              & \textit{Total distance travelled}                                                                                                              \\ \hline
Circadian Movement          & \textit{The degree to which changes in the location follow a 24 hour rhythm}                        \\ \hline
\end{tabular}
    \caption{The Mobility Features defined by Saeb et al. \cite{Saeb2015}}
    \label{tab:saeb-features}
\end{table}



\begin{table}[h]
    \centering
\begin{tabular}{|p{0.4\textwidth}|p{0.5\textwidth}|}
\hline
{\ul \textbf{Feature}}       & {\ul \textbf{Description}}                                                                                                                                        \\ \hline
Place                        & \textit{A location the user frequently visits}                                                                                                                    \\ \hline
Significant Place            & \textit{Significant places are the top 10 most visited places out of all places}                                                                                  \\ \hline
Stop                         & \textit{A visit at a place}                                                                                                                                       \\ \hline
Move                         & \textit{A trajectory between two places}                                                                                                                          \\ \hline
Mobility Trace               & \textit{The stops and moves a given time interval}                                                                                                                \\ \hline
Total Distance               & \textit{Distance travelled for a given time interval}                                                                                                             \\ \hline
Max Distance                 & \textit{Maximum distance between any two points for a given time interval}                                                                                        \\ \hline
Radius of Gyration           & \textit{Radius of the area covered for a given time interval}                                                                                                     \\ \hline
Std. of Displacement         & \textit{Standard deviation for stop locations for a given time interval}                                                                                          \\ \hline
Max Distance from Home       & \textit{Maximum distance from home to any place visited in a given time interval}                                                                                 \\ \hline
Number of Places             & \textit{The number of unique places visisted for a given time interval}                                                                                           \\ \hline
Number of Significant Places & \textit{The number of unique significant places visited for a given time interval}                                                                                \\ \hline
Routine Index                & \textit{The average difference between the mobility behaviour of the user for a given interval, on a given day, compared to the same time interval on other days} \\ \hline
\end{tabular}
    \caption{The Mobility Features defined by Canzian et al. \cite{Canzian2015}}
    \label{tab:canzian-features}
\end{table}


The work by Ashbrook et al. \cite{learning_significant_locations} from 2002 is one of the earliest contributions to the field of GPS data based context. Here, user context refers to where the user will move next, given their current location. While this is not related to mental health necessarily, it is interesting to look into the approach taken given that it is a pioneering contribution. Smartphones did not exist in 2002 and therefore an old-fashioned GPS receiver was used for data colelction. This receiver could not receive signal inside most buildings and this was used to identify what the author refers to as \textit{places}. Places are physical locations where the GPS signal is interrupted for a period of time and by clustering these places, the \textit{location} features are computed. Sensors back then had a 15 meter accuracy meaning the location coordinates reported may be somewhat noisy from day to day. In order to identify the mean of these noisy place locations, a modified version of the \textit{K-means} clustering algorithm was applied to the data. Locations are therefore the centroids of place-clusters. Inside \textit{locations}, \textit{sub-locations} can be found, which are networks of smaller locations. A good example of a location with sub-locations is a university campus, where the sub-locations are the different department offices or even buildings. All these features are listed in Table \ref{tab:features-ashbrook}. 

\begin{table}[]
    \centering
\begin{tabular}{|p{0.4\textwidth}|p{0.5\textwidth}|}
\hline
\textbf{Feature} & \textbf{Description}                                                               \\ \hline
Place            & \textit{A geo-location at which the GPS signal could not reach such as a building} \\ \hline
Location         & \textit{The centroid of a cluster of places}                                       \\ \hline
Sublocation      & \textit{A location within a location, i.e. university building on a uni-campus}    \\ \hline
\end{tabular}
    \caption{The Mobility Features defined by Ashbrook et al. \cite{learning_significant_locations}}
    \label{tab:features-ashbrook}
\end{table}


% Saeb method
\subsection{Methods}
Canzian collected data from 46 users over almost 10 months on a voluntary basis and had participants fill out a survey daily between 16:00 and 02:00 the subsequent day, where a phone notification prompted the participant to fill out the survey. Each survey contained a 'trap' question which asked whether the user was current at home or work. The answer to this question could be verified in the data analysis phase, and was used to filter out invalid surveys. The survey asked the user to name all the depressive symptoms they had on that day. PHQ8 score is normally done by asking every 14 days, and have the participant answer how many times they had a symptom over the last 14 days. By using the questionnaires, the PHQ8 scores could be computed by summing the amount of days with the symptoms, which in total add up to a score. It would happen that users forgot to fill out their questionnaire or gave an invalid survey reponse, in which case an interpolation method was used to cover gaps in the data. 

For location data processing, Saeb et al. uses a two-stage pipeline: 
\begin{itemize}
    \item Each data point is labeled as either being in a stationary or transitional state by using the speed of each data point. Points are labeled using a threshold of 1 km/h; a speed lower than the threshold indicates the state is stationary and higher is a transitional point. 
    \item The K-means clustering algorithm to group the \textit{stationary points} into frequently visited places. Since the number of places, i.e. the number of clusters for the K-means algorithm (the parameter \textit{K}) is not known beforehand, the best parameter value is found using cross-validation.
\end{itemize}

After this pre-processing procedure was applied, the features described in Table \ref{tab:saeb-features} were derived.
Saeb et al. find that depressive symptoms tend to change slowly over weeks, with little day-to-day variation and thus it is more relevant to group data on a weekly basis.




